<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>The Marriage Equality Pulse</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- Custom styles for this template -->
    <link href="css/freelancer.min.css" rel="stylesheet">

    <!-- Plotly source -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  </head>

  <body id="page-top">
 
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top">The Marriage Equality Pulse</a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#portfolio">The Pulse</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#about">How it works</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#means">What it means</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#contact">Get involved</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <header class="masthead">
      <div class="container">
        <img class="img-fluid" src="img/heart.svg" width=300px height=300px alt="">
        <div class="intro-text">
          <span class="name">The Marriage Equality Pulse</span>
          <hr class="star-light">
          <span class="skills">A simple analysis of Google Trends to keep a watch on public sentiment leading up to the Australian marriage equality postal survey.</span>
        </div>
      </div>
    </header>


    <!-- Portfolio Grid Section -->
    <section id="portfolio">
      <div class="container">
        <h2 class="text-center">The pulse
        </h2>
        <hr class="star-primary">
        <p style="text-align: center">Google Trends search sentiment in favour of 'vote yes' is:</p>
        <div class="row">
          <div class = "col-md-4 stat"><h2 data-bind="text: onehr">%</h2><p>in the last hour</div>
          <div class = "col-md-4 stat"><h2 data-bind="text: twelvehr">%</h2><p>in the last 12 hours</div>
          <div class = "col-md-4 stat"><h2 data-bind="text: sevenday">0%</h2><p>in the last 7 days</div>
          </div>
          <p style="text-align: center; font-size: 12px; padding-bottom:20px">Last data update <span data-bind="text: lastupdated"></span></p>
      </div>
      <div class="container">
        <h2 class="text-center">The daily pulse chart
        <p style="text-align: center"></p>
        </h2>
        <hr class="star-primary">
        <div class="row">
          <div class = "col-12" id="pulse-chart-2" style="height:380px;">
        </div>
      </div>
      <div class="container">
        <p style="padding-top: 50px;">
        <h2 class="text-center">The hourly pulse chart
            <p style="text-align: center">Hourly search intensity for 'vote yes' and 'vote no'</p>
        </h2>
        <hr class="star-primary">
        <div class="row">
          <div class = "col-12" id="pulse-chart" style="height:380px;">
        </div>
      </div>
    </section>

    <!-- About Section -->
    <section class="success" id="about">
      <div class="container">
        <h2 class="text-center">How it works</h2>
        <hr class="star-light">
        <div class="row">
        
          <div class="col"></div>
          <div class = "col-8 text-center">
            <p>The Pulse measures the rate of Google searches for the phrases 'vote yes' and 'vote no' within Australia using the 'Google Trends' tool.</p>
            <p>The share of 'vote yes' in this search intensity is the Pulse. A pulse above 50% means sentiment favours 'vote yes'. A pulse below 50% means sentiment favours 'vote no'.</p>
            <p>The Pulse and the accompanying charts update every 15 minutes.</p>
          </div>
          <div class="col"></div>
          <div class="col-lg-8 mx-auto text-center">
            <a href="https://github.com/pboulus/pboulus.github.io/tree/master/gay-marriage-pulse" class="btn btn-lg btn-outline" target="_blank">
              View the repo
            </a>
          </div>
        </div>
      </div>
    </section>

        <!-- About Section -->
        <section class="success2" id="means">
          <div class="container">
            <h2 class="text-center">What it means</h2>
            <hr class="star-primary-invert star-primary">
            <div class="row">
            
              <div class="col"></div>
              <div class = "col-8 text-center">
                <p>A similar analysis of Google search data predicted the outcome of the 
                  Irish marriage equality referendum in 2015. You can read that
                  study <a href="http://ftp.iza.org/dp9570.pdf" target="_blank">here</a>.</P>
                  <p>This kind of analysis is likely to have more predictive power closer to the date of 
                  a vote, as voter intent crystallises. It may not have much predictive power in the weeks and months
                  before a vote. The absence of a defined 'voting day' for the Australian postal survey may dilute 
                the predictive power of the Pulse.</p>
                
                
              </div>
              <div class="col"></div>
              <div class="col-lg-8 mx-auto text-center">
              </div>
            </div>
          </div>
        </section>

    <!-- Contact Section -->
    <section id="contact">
      <div class="container">
        <h2 class="text-center">Get involved</h2>
        <hr class="star-primary">
        <div class="row">
          <div class="col">
            </div>
            <div class = "col-8 text-center">
              <p>The Australian Government is pursuing an Australian Marriage Law Postal Survey.</p>
              <p>If the survey isn't struck down by the courts, marriage equality supporters need 
                to make sure they do what they can to encourage people to <strong>VOTE YES</strong>.</p>          
              <p>You can help through your preferred campaign organisation, but if you don't belong 
                to one you can jump on the Australian Marriage Equality campaign.</p>
                <p style="text-align:center; font-weight:bold;"><a href="http://www.equalitycampaign.org.au" target="_blank">Donate to Australian Marriage Equality</a></p>
                <p style="text-align:center; font-weight:bold;"><a href="http://yes.org.au" target="_blank">Sign up to volunteer at yes.org.au</a></p>
             
            </div>
            <div class="col">
            </div>
          
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="text-center">
      <div class="footer-above">
        <div class="container">
          <div class="row">
            <div class="footer-col col-md-2">
              <!--
              <h3>Location</h3>
              <p>Sydney
                <br>Australia</p>
            <-->
              </div>
            
            <div class="footer-col col-md-8">
              <h3>About me</h3>
              <p>I'm a management consultant and 
                amateur programmer based in Sydney, Australia.
              I built this site to help illuminate public sentiment
            in the lead up to the Australian Marriage Law Postal Survey.</p>
            </div>
             
            <div class="footer-col col-md-2">
             <!--
              <h3>My profiles</h3>
               
            
                  </li>
                  <li class="list-inline-item">
                    <a class="btn-social btn-outline" href="#">
                      <i class="fa fa-fw fa-google-plus"></i>
                    </a>
                  </li>
                  <li class="list-inline-item">
                    <a class="btn-social btn-outline" href="#">
                      <i class="fa fa-fw fa-twitter"></i>
                    </a>
                  </li>
                
                <ul class="list-inline">
                    <li class="list-inline-item">
                      <a class="btn-social btn-outline" href="https://facebook.com/paul.boulus" target="_blank">
                        <i class="fa fa-fw fa-facebook"></i>
                  </a>
                  <li class="list-inline-item">
                    <a class="btn-social btn-outline" href="https://www.linkedin.com/in/paulboulus/" target="_blank">
                      <i class="fa fa-fw fa-linkedin"></i>
                    </a>
                  </li>
                  
                  <li class="list-inline-item">
                    <a class="btn-social btn-outline" href="#">
                      <i class="fa fa-fw fa-dribbble"></i>
                    </a>
                  </li>
                </ul>
              -->
              </div>
          </div>
        </div>
      </div>
      <div class="footer-below">
        <div class="container">
          <div class="row">
            <div class="col-lg-12">
                <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.<br><br><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-top d-lg-none">
      <a class="btn btn-primary js-scroll-trigger" href="#page-top">
        <i class="fa fa-chevron-up"></i>
      </a>
    </div>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/popper/popper.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>
    <script src="js/knockout.js"></script>
    
    <!-- Custom scripts for this template -->
    <script src="js/freelancer.min.js"></script>
    <script>
    Plotly.d3.csv('https://raw.githubusercontent.com/pboulus/pboulus.github.io/master/gay-marriage-pulse/app/result.csv', function(rows){
      var trace1 = {
        type: 'scatter',                    // set the chart type
        mode: 'lines',                      // connect points with lines
        x: rows.map(function(row){          // set the x-data
          return row['date'];
        }),
        y: rows.map(function(row){          // set the x-data
          return row['yes_rolling'];
        }),
        line: {                             // set the width of the line.
          width: 2,
          color: 'rgb(227, 14, 32)'
        },
        name: '\'Vote Yes\''
      };

      var trace2 = {
        type: 'scatter',                    // set the chart type
        mode: 'lines',                      // connect points with lines
        x: rows.map(function(row){          // set the x-data
          return row['date'];
        }),
        y: rows.map(function(row){          // set the x-data
          return row['no_rolling'];
        }),
        line: {                             // set the width of the line.
          width: 2,
          color: 'rgb(45, 4, 40)'
        },
        name: '\'Vote No\''
      };

      
  
      var layout = {
        yaxis: {title: "Search intensity",
        hoverformat: ',.0f'},       // set the y axis title
        xaxis: {
          showgrid: false,                  // remove the x-axis grid lines
          tickformat: "%d-%b"              // customize the date format to "day-month"
        },
        margin: {                           // update the left, bottom, right, top margin
          l: 40, b: 30, r: 20, t: 20
        },
        hoverinfo: "none",
        legend: {
          x: 0.05,
          y: 0.95
        }
      };
      var data = [trace1, trace2];
      Plotly.plot(document.getElementById('pulse-chart'), data, layout, {showLink: false, displayModeBar:  false});

      
  });
  </script>
<script>
  Plotly.d3.csv('https://raw.githubusercontent.com/pboulus/pboulus.github.io/master/gay-marriage-pulse/app/result-grouped.csv', function(rows){
    var trace1 = {
      type: 'scatter',                    // set the chart type
      mode: 'lines',                      // connect points with lines
      x: rows.map(function(row){          // set the x-data
        return row['date'];
      }),
      y: rows.map(function(row){          // set the x-data
        return row['odds']*100;
      }),
      line: {                             // set the width of the line.
        width: 0.3,
        style: '--',
        color: 'rgb(227, 14, 32)'
      },
      name: 'Share of \'Vote Yes\''
    };
    var trace2 = {
      type: 'scatter',                    // set the chart type
      mode: 'lines',                      // connect points with lines
      x: rows.map(function(row){          // set the x-data
        return row['date'];
      }),
      y: rows.map(function(row){          // set the x-data
        return row['odds_rolling']*100;
      }),
      line: {                             // set the width of the line.
        width: 2,
        color: 'rgb(227, 14, 32)'
      },
      name: 'Rolling 7 day average'
    };

    var trace3 = {
      type: 'scatter',                    // set the chart type
      mode: 'lines',                      // connect points with lines
      x: rows.map(function(row){          // set the x-data
        return row['date'];
      }),
      y: Array(500).fill(50),
      line: {                             // set the width of the line.
        width: 1,
        color: 'rgb(0,0,0)'
      },
      name: '50:50 yes:no',
      showlegend: false
    };


    var layout = {
      yaxis: {title: "Share",
              range: [0, 100],
              ticksuffix: '%',
              hoverformat: '.0f'},       // set the y axis title
      xaxis: {
        showgrid: false,                  // remove the x-axis grid lines
        tickformat: "%d-%b"              // customize the date format to "day-month"
      },
      margin: {                           // update the left, bottom, right, top margin
        l: 40, b: 30, r: 20, t: 20
      },
      hoverinfo: "none",
      legend: {
        x: 0.75,
        y: 1.05
      }
    };
    var data = [trace1, trace2, trace3];
    Plotly.plot(document.getElementById('pulse-chart-2'), data, layout, {showLink: false, displayModeBar:  false});
});
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-105819075-1', 'auto');
  ga('send', 'pageview');

</script>
<script>
  // Here's my data model
  $.getJSON("https://raw.githubusercontent.com/pboulus/pboulus.github.io/master/gay-marriage-pulse/app/keyvars.json", function(json) {
    function MyViewModel(json) {
      console.log(json)
      this.lastupdated = json[0];
      this.onehr = json[2];
      this.twelvehr = json[3];
      this.sevenday = json[4];
}
ko.applyBindings(new MyViewModel(json));
  });
  
</script>
  </body>

</html>
